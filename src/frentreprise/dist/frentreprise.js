!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("frentreprise",[],t):"object"==typeof exports?exports.frentreprise=t():e.frentreprise=t()}(global,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=22)}([function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.default={convertDate:e=>(e>1e11&&(e/=1e3),+e&&new Date(1e3*e)||void 0),getCleanAddress:e=>`\n    ${e.numero_voie||""} ${e.type_voie||""} ${e.nom_voie||""}\n    ${e.complement_adresse||""} ${e.code_postal||""}\n    ${e.localite||""}\n    `.trim().split("\n").map(e=>e.trim().replace(/\s+/g," ")).filter(e=>e.length>0).join("\n"),isEmpty:e=>null==e||"object"==typeof e&&0===Object.keys(e).length||"string"==typeof e&&0===e.trim().length,requestAPI:(r=function*(e,t,n={}){try{const r=yield e.get(t,n);if(r&&r.data){const e=r.request&&r.request.res&&r.request.res.responseUrl;return console.log(`Request successed for ${e}`),r.data||{}}}catch(e){if(e&&"request"in e){let{message:t,request:n,response:r,config:o}=e;"object"!=typeof o&&(o={}),"object"!=typeof n.res&&(n.res={}),"object"!=typeof r&&(r={}),r.data||(r.data="(no data)");let{responseUrl:i}=n.res;i=i||n._currentUrl||("object"==typeof n._currentRequest||"string"==typeof n.path?`${(""+(o.baseURL||"(unknown host)")).replace(/^(https?:\/\/[^\/]*).*$/i,"$1")}${n._currentRequest&&n._currentRequest.path||n.path}`:"unknown url");const a="object"==typeof r.data?JSON.stringify(r.data,!0,2):r.data,s=JSON.stringify(o.proxy||!1,!0,2);console.error(`\n--\n⚠️  ${t}\n${i}\nProxy: ${s}\n--\n${a}\n--\n`.trim())}else console.error(e)}return Promise.resolve({})},o=function(){var e=r.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t){return o.apply(this,arguments)})}},function(e,t,n){"use strict";var r=n(10),o=n(43),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return null!==e&&"object"==typeof e}function u(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return s(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)c(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,o=arguments.length;r<o;r++)c(arguments[r],n);return t},extend:function(e,t,n){return c(t,function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0)),o=a(n(5)),i=a(n(6));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const u=(c=s(function*(e,t){const n=function(e){return e&&{numero_voie:e.numeroVoieEtablissement,indice_repetition:e.indiceRepetitionEtablissement,type_voie:e.typeVoieEtablissement,nom_voie:e.libelleVoieEtablissement,complement_adresse:e.complementAdresseEtablissement,code_postal:e.codePostalEtablissement,code_insee_localite:e.codeCommuneEtablissement,localite:e.libelleCommuneEtablissement}},i=["siret",{in:"periodesEtablissement[0].etatAdministratifEtablissement",out:"actif",callback:function(e){return e&&"A"===e}},{in:"periodesEtablissement[0].etatAdministratifEtablissement",out:"etat_etablissement"},{in:"periodesEtablissement[0].dateDebut",out:"date_fin"},{in:"dateDernierTraitementEtablissement",out:"date_dernier_traitement_etablissement"},"enseigne",{in:"uniteLegale.activitePrincipaleUniteLegale",out:"naf"},{in:"uniteLegale.activitePrincipaleUniteLegale",out:"libelle_naf",callback:(a=s(function*(e){return r.default.isEmpty(e)?void 0:yield d(e,t)}),function(e){return a.apply(this,arguments)})},{in:"etablissementSiege",out:"siege_social"},{in:"etablissementSiege",out:"categorie_etablissement",callback:function(e){return r.default.isEmpty(e)?void 0:e?"Siège social":"Établissement secondaire"}},{in:"dateCreationEtablissement",out:"date_creation"},{in:"trancheEffectifsEtablissement",out:"tranche_effectif_insee"},{in:"anneeEffectifsEtablissement",out:"annee_tranche_effectif_insee"},{in:"adresseEtablissement",out:"adresse_components",callback:function(e){const t=n(e);return r.default.isEmpty(t)?void 0:t}},{in:"adresseEtablissement",out:"adresse",callback:function(e){const t=n(e);return r.default.isEmpty(t)?void 0:r.default.getCleanAddress(t)}},{in:"periodesEtablissement[0].caractereEmployeurEtablissement",out:"etablissement_employeur"}];var a;return"object"==typeof e?yield(0,o.default)(e,i):{}}),function(e,t){return c.apply(this,arguments)});var c;const f=(l=s(function*(e,t){const n=["siren",{in:"periodesUniteLegale[0].denominationUniteLegale",out:"raison_sociale"},{in:"sigleUniteLegale",out:"sigle"},{in:"periodesUniteLegale[0]nomUniteLegale",out:"nom"},{in:"prenom1UniteLegale",out:"prenom",callback:function(e,t){return r.default.isEmpty([t.prenom1UniteLegale,t.prenom2UniteLegale,t.prenom3UniteLegale,t.prenom4UniteLegale].filter(function(e){return e}).join(" "))?void 0:[t.prenom1UniteLegale,t.prenom2UniteLegale,t.prenom3UniteLegale,t.prenom4UniteLegale].filter(function(e){return e}).join(" ")}},{in:"periodesUniteLegale[0].nomUsageUniteLegale",out:"nom_commercial"},{in:"categorieEntreprise",out:"categorie_entreprise"},{in:"periodesUniteLegale[0]",out:"siret_siege_social",defaultValue:{},callback:function(e,t){return r.default.isEmpty(t.siren)||r.default.isEmpty(e.nicSiegeUniteLegale)?void 0:`${t.siren}${e.nicSiegeUniteLegale}`}},{in:"periodesUniteLegale[0].categorieJuridiqueUniteLegale",out:"categorie_juridique",callback:(a=s(function*(e){return r.default.isEmpty(e)?void 0:yield h(e,t)}),function(e){return a.apply(this,arguments)})},{in:"periodesUniteLegale[0].categorieJuridiqueUniteLegale",out:"categorie_juridique_code"},{in:"periodesUniteLegale[0].activitePrincipaleUniteLegale",out:"naf"},{in:"periodesUniteLegale[0].activitePrincipaleUniteLegale",out:"libelle_naf",callback:(i=s(function*(e){return r.default.isEmpty(e)?void 0:yield d(e,t)}),function(e){return i.apply(this,arguments)})},{in:"dateCreationUniteLegale",out:"date_de_creation"},{in:"periodesUniteLegale[0].etatAdministratifUniteLegale",out:"etat_entreprise"},{in:"periodesUniteLegale[0]",out:"date_mise_a_jour",defaultValue:{},callback:function(e,t){return"C"===e.etatAdministratifUniteLegale?e.dateFin:t.dateDernierTraitementUniteLegale}},{in:"periodesUniteLegale[0].dateFin",out:"date_de_radiation"},{in:"periodesUniteLegale[0].caractereEmployeurUniteLegale",out:"entreprise_employeur"},{in:"anneeEffectifsUniteLegale",out:"annee_tranche_effectif"},{in:"trancheEffectifsUniteLegale",out:"tranche_effectif"}];var i,a;return"object"==typeof e?yield(0,o.default)(e,n):{}}),function(e,t){return l.apply(this,arguments)});var l;const d=(p=s(function*(e,t){if(!t)return;const n=i.default.create({baseURL:"https://api.insee.fr/metadonnees/nomenclatures/v1/codes/nafr2/sousClasse/",timeout:5e3});return t.timeout=5e3,yield r.default.requestAPI(n,`${e}`,t).then(function(e){return r.default.isEmpty(e.intitule)?void 0:e.intitule})}),function(e,t){return p.apply(this,arguments)});var p;const h=(m=s(function*(e,t){if(!t)return;const n=i.default.create({baseURL:"https://api.insee.fr/metadonnees/nomenclatures/v1/codes/cj/n3/",timeout:5e3});return t.timeout=5e3,yield r.default.requestAPI(n,`${e}`,t).then(function(e){return r.default.isEmpty(e.intitule)?void 0:e.intitule})}),function(e,t){return m.apply(this,arguments)});var m;t.default={formatEtab:u,formatEnt:f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSIREN=function(e,t=!1){if(!/^[0-9]{9}$/.test(e))return!1;if(!t)return!0;return e.split("").reduce((e,t,n)=>{t=+t;const r=n%2==0;return r?e+t:e+((t*=2)>9?t-9:t)},0)%10==0},t.validateSIRET=function(e,t=!1){if(!/^[0-9]{14}$/.test(e))return!1;if(!t)return!0;return e.split("").reduce((e,t,n)=>{t=+t;const r=n%2!=0;return r?e+t:e+((t*=2)>9?t-9:t)},0)%10==0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(27),i=(r=o)&&r.__esModule?r:{default:r};function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}t.default=class{getSIRET(){return a(function*(){throw new i.default})()}getSIREN(){return a(function*(){throw new i.default})()}search(){return a(function*(){throw new i.default})()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o,i,a=n(30),s=(r=a)&&r.__esModule?r:{default:r};t.default=(o=function*(e,t){const n={};for(const r of t){const t="object"==typeof r?r.in:r,o="object"==typeof r?r.out:r,i="object"==typeof r&&r.defaultValue?r.defaultValue:void 0;let a=(0,s.default)(e,t,i);r.callback&&(a=yield r.callback(a,e)),n[o]="boolean"==typeof a?a:a||void 0}return n},i=function(){var e=o.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t){return i.apply(this,arguments)})},function(e,t,n){"use strict";e.exports=n(42)},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(3);Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}),t.cleanObject=function(e){const t=r({},e);return Object.keys(t).reduce((e,n)=>(null!==t[n]&&void 0!==t[n]&&(e[n]=t[n]),e),{})}},function(e,t){e.exports=require("tunnel")},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(1),o=n(48),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,u={adapter:("undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)?s=n(49):"undefined"!=typeof XMLHttpRequest&&(s=n(55)),s),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],function(e){u.headers[e]={}}),r.forEach(["post","put","patch"],function(e){u.headers[e]=r.merge(i)}),e.exports=u},function(e,t,n){"use strict";var r=n(7);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";var r=n(1);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))}))}),i=a.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t){e.exports=require("follow-redirects")},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){t=t||{};var n={};return r.forEach(["url","method","params","data"],function(e){void 0!==t[e]&&(n[e]=t[e])}),r.forEach(["headers","auth","proxy"],function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):void 0!==t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):void 0!==e[o]&&(n[o]=e[o])}),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])}),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),o=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const s=(u=a(function*(e,t,n,i=!1){return yield r.default.requestAPI(t,`siret/?q=siren:${e}&nombre=10000`,n).then((s=a(function*(e){if(!e.etablissements)return{};const t=yield Promise.all(e.etablissements.map((r=a(function*(e){return yield o.default.formatEtab(e,i?null:n)}),function(e){return r.apply(this,arguments)})));var r;return{nombre_etablissements_actifs:t.filter(function(e){return e.actif}).length,_ets:t}}),function(e){return s.apply(this,arguments)}));var s}),function(e,t,n){return u.apply(this,arguments)});var u;t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Etablissement=t.Entreprise=void 0;var r=n(72);Object.defineProperty(t,"Entreprise",{enumerable:!0,get:function(){return a(r).default}});var o=n(73);Object.defineProperty(t,"Etablissement",{enumerable:!0,get:function(){return a(o).default}});var i=a(r);function a(e){return e&&e.__esModule?e:{default:e}}t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};const o=Symbol("_importData"),i=Symbol("_data");t.default=class{constructor(e={}){this[o](e,!0)}updateData(e){this[o](e)}replaceData(e){this[o](e,!0)}getData(){return this[i]}[o](e,t=!1){const n=e=>e||!1===e;if("object"==typeof e)if(t||void 0===this[i])this[i]=r({},e);else for(const[t,o]of Object.entries(e))this[i].hasOwnProperty(t)&&!n(o)||(this[i]=r({},this[i],{[t]:o}));Object.keys(this[i]).forEach(e=>{this.hasOwnProperty(e)||Object.defineProperty(this,e,{get:()=>this[i][e]})},this)}};t._protected={_importData:o}},function(e,t,n){e.exports=n(23)},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=l(n(24)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(3)),a=l(n(25)),s=l(n(64)),u=l(n(4)),c=n(20),f=n(8);function l(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const p={dataSources:Symbol("_dataSources"),compareDataSource:Symbol("_compareDataSource"),askDataSource:Symbol("_askDataSource"),isValidDataSources:Symbol("_isValidDataSources")};e.exports=new class{constructor(){this.EntrepriseModel=c.Entreprise,this.EtablissementModel=c.Etablissement,this[p.dataSources]=[],this.addDataSource({name:"ApiGouv",priority:80,source:new a.default("https://entreprise.api.gouv.fr:443/v2/")}),this.addDataSource({name:"SireneAPI",priority:100,source:new s.default("https://api.insee.fr/entreprises/sirene/V3/")})}getEntreprise(e){var t=this;return d(function*(){e+="";const n=i.validateSIREN(e),a=i.validateSIRET(e);if(!n&&!a)throw new o.default(e);const s=n?e:e.substr(0,9),u=new t.EntrepriseModel({_dataSources:{}},t.EtablissementModel);yield t[p.askDataSource]("getSIREN",s,function(e){console.log(`Using response from dataSource named ${e.source.name} with priority : ${e.source.priority}`),u.updateData(r({},e.data,{_dataSources:r({},u._dataSources,{[e.source.name]:!!Object.keys(e.data).length})}))});const c=a?e:""+u.siret_siege_social,f=Object.keys({[u.siret_siege_social]:!0,[c]:!0});return yield Promise.all(f.map(function(e){if(i.validateSIRET(e))return t[p.askDataSource]("getSIRET",e,function(t){console.log(`Using response from dataSource named ${t.source.name} with priority : ${t.source.priority}`);const n=u.getEtablissement(e);n.updateData(r({},t.data,{_dataSources:r({},n._dataSources,{[t.source.name]:!!Object.keys(t.data).length})}))})})),u.updateData({_success:t[p.isValidDataSources](u._dataSources)}),u.etablissements.map(function(e){e.updateData({_success:t[p.isValidDataSources](e._dataSources)})}),u})()}search(e){var t=this;return d(function*(){const n={};let o=!1;yield t[p.askDataSource]("search",e,function(e){const a=e.data;!1===a?console.log(`Source named ${e.source.name} doesn't support search. (it returned false)`):Array.isArray(a)?(console.log(`Using response from dataSource named ${e.source.name} with priority : ${e.source.priority}`),a.forEach(function(o){const a=i.validateSIREN(o.siren)&&o.siren||o.siret.substr(0,9),s=i.validateSIRET(o.siret)&&o.siret;i.validateSIREN(a)&&(n[a]||(n[a]=new t.EntrepriseModel({siren:a,_dataSources:{}},t.EtablissementModel)),s?n[a].getEtablissement(s).updateData(r({},(0,f.cleanObject)(o),{_dataSources:r({},n[a].getEtablissement(s)._dataSources,{[e.source.name]:!0})})):n[a].updateData((0,f.cleanObject)(o)))})):("object"==typeof a&&a.hasOwnProperty("error")&&!0===a.error&&(o=!0),console.error(`Source named ${e.source.name} returned invalid data for search, array expected. Received:`,a))});let a=Object.values(n);return!(!a.length&&o)&&a})()}getDataSources(){return[...this[p.dataSources]].sort(this[p.compareDataSource])}getDataSource(e){return this[p.dataSources].find(t=>t.name===e)}addDataSource(e){this[p.dataSources].includes(e)||this[p.dataSources].push(e)}removeDataSource(e){this[p.dataSources]=this[p.dataSources].filter(t=>t!==e)}[p.compareDataSource](e,t){return(e=+(e&&e.priority))>(t=+(t&&t.priority))?1:e<t?-1:0}[p.askDataSource](e,t,n=(e=>e)){return Promise.all(this.getDataSources().map(n=>(console.log(`Asking [${e}] to dataSource named ${n.name} with request : ${JSON.stringify(t)}`),n.source[e](t).then(r=>{const o="object"==typeof r?Array.isArray(r)?r.map(f.cleanObject):(0,f.cleanObject)(r):r;return console.log(`Got response for [${e}] from dataSource named ${n.name} about request : ${JSON.stringify(t)}`),Promise.resolve({source:n,data:o})})))).then(e=>{e.sort((e,t)=>e.source&&t.source&&this[p.compareDataSource](e,t)||0).map(n)})}[p.isValidDataSources](e){return e&&!!Object.values(e).includes(!0)}},e.exports.Entreprise=c.Entreprise,e.exports.Etablissement=c.Etablissement,e.exports.DataSource=u.default,e.exports.isSIRET=i.validateSIRET,e.exports.isSIREN=i.validateSIREN,e.exports._=p},function(e,t,n){"use strict";function r(e){this.message=`Invalid SIRET or SIREN. ${e}`}Object.defineProperty(t,"__esModule",{value:!0}),r.prototype=Object.create(Error.prototype,{constructor:{value:r},name:{value:"InvalidIdentifierError"},stack:{get:function(){return(new Error).stack}}}),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(26),i=(r=o)&&r.__esModule?r:{default:r};t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=c(n(9)),i=c(n(4)),a=c(n(28)),s=c(n(37)),u=c(n(6));function c(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const l=t._={axios:Symbol("_axios"),requestAPIs:Symbol("_requestAPIs")};t.default=class extends i.default{constructor(e,t={}){super(),this.token=null,this[l.axios]=u.default.create({baseURL:e,timeout:3e4}),this.axiosConfig=t}getSIRET(e){var t=this;return f(function*(){return yield t[l.requestAPIs](e,a.default.getEtablissement,a.default.agefiph,a.default.exercices,a.default.association,a.default.predecesseur,a.default.successeur,a.default.document_association)})()}getSIREN(e){var t=this;return f(function*(){return yield t[l.requestAPIs](e,s.default.getEntreprise,s.default.attestation_acoss,s.default.attestation_dgfip,s.default.infogreffe_rcs)})()}search(){return f(function*(){return!1})()}[l.requestAPIs](e,...t){var n=this;return f(function*(){let i={};const a=r({},n.axiosConfig,{params:{token:n.token,context:"Tiers",recipient:"Direccte Occitanie",object:"FCEE - Direccte Occitanie"}});if(a.proxy&&!0===a.proxy.tunnel){const e={proxy:{}};a.proxy.host&&(e.proxy.host=a.proxy.host),a.proxy.port&&(e.proxy.port=a.proxy.port),a.proxy.auth&&(e.proxy.proxyAuth=`${a.proxy.auth.username||""}:${a.proxy.auth.password||""}`),a.proxy=!1,a.httpsAgent=o.default.httpsOverHttp(e)}const s=t.filter(function(e){return"function"==typeof e}).map(function(t){return t(e,n[l.axios],a)});return yield Promise.all(s).then(function(e){Object.assign(i,...e)}),i})()}}},function(e,t,n){"use strict";function r(e){const t=(new Error).stack.split("\n")[2].replace(" at ","");this.message=`The method ${t} isn't implemented.`,e&&(this.message+=` Message: "${e}".`);let n=this.message;for(;n.indexOf("  ")>-1;)n=n.replace("  "," ");this.message=n}Object.defineProperty(t,"__esModule",{value:!0}),r.prototype=Object.create(Error.prototype,{constructor:{value:r},name:{value:"NotImplementedError"},stack:{get:function(){return(new Error).stack}}}),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(29)),o=f(n(31)),i=f(n(32)),a=f(n(33)),s=f(n(34)),u=f(n(35)),c=f(n(36));function f(e){return e&&e.__esModule?e:{default:e}}t.default={getEtablissement:r.default,exercices:o.default,agefiph:i.default,association:a.default,predecesseur:s.default,successeur:u.default,document_association:c.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}const a=(s=function*(e,t,n){return yield r.default.requestAPI(t,`etablissements/${e}`,n).then(function(e){const t=["siret","siege_social",{in:"siege_social",out:"categorie_etablissement",callback:function(e){return r.default.isEmpty(e)?void 0:e?"Siège social":"Établissement secondaire"}},"enseigne","naf","libelle_naf",{in:"date_creation_etablissement",out:"date_creation",callback:function(e){return r.default.convertDate(e)}},{in:"region_implantation.code",out:"code_region",callback:function(e){return e&&+e}},{in:"region_implantation.value",out:"region"},{in:"tranche_effectif_salarie_etablissement",out:"etablissement_employeur",callback:function(e){return e&&+e.a>0}},{in:"tranche_effectif_salarie_etablissement.intitule",out:"tranche_effectif_insee"},{in:"tranche_effectif_salarie_etablissement.date_reference",out:"annee_tranche_effectif_insee",callback:function(e){return e&&+e}},{in:"adresse",out:"adresse",callback:function(e){return"object"==typeof e?r.default.getCleanAddress(e):void 0}},{in:"adresse",out:"adresse_components"},{in:"adresse",out:"departement",callback:function(e){return"object"==typeof e?"string"==typeof e.code_insee_localite&&e.code_insee_localite.length>1&&e.code_insee_localite.substr(0,2):void 0}}];return e&&e.etablissement?(0,o.default)(e.etablissement,t):{}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t){e.exports=require("lodash.get")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`exercices/${e}`,n).then(function(e){if(e&&Array.isArray(e.exercices)){const t={};return e.exercices.forEach(function(e){t[i.default.convertDate(e.date_fin_exercice_timestamp).toISOString()]=+e.ca||null}),{donnees_ecofi:t}}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`attestations_agefiph/${e}`,n).then(function(e){return{derniere_annee_de_conformite_connue:e.derniere_annee_de_conformite_connue||null}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`associations/${e}`,n).then(function(e){if(e.association&&"object"==typeof e.association&&e.association.etat&&e.association.id)return{association:e.association}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`etablissements/${e}/predecesseur`,n).then(function(e){if(e&&e.predecesseur){const t=e.predecesseur;if(t)return{predecesseur:{siret:t.predecesseur_siret,date_transfert:i.default.convertDate(t.predecesseur_date_etablissement)}}}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`etablissements/${e}/successeur`,n).then(function(e){if(e&&e.successeur){const t=e.successeur;if(t)return{successeur:{siret:t.successeur_siret,date_transfert:i.default.convertDate(t.successeur_date_etablissement),transfert_siege:!!t.transfert_siege}}}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`documents_associations/${e}`,n).then(function(e){if(e.documents&&Array.isArray(e.documents)&&e.documents.length){return{document_association:e.documents.reduce(function(e,t){return"Statuts"===t.type&&+t.timestamp>+e.timestamp&&t||e},{timestamp:0})}}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(38)),o=s(n(39)),i=s(n(40)),a=s(n(41));function s(e){return e&&e.__esModule?e:{default:e}}t.default={getEntreprise:r.default,attestation_dgfip:o.default,attestation_acoss:i.default,infogreffe_rcs:a.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}const a=(s=function*(e,t,n){return yield r.default.requestAPI(t,`entreprises/${e}`,n).then(function(e){const t=["categorie_entreprise","siren","raison_sociale","nom_commercial","nom","prenom","siret_siege_social","capital_social",{in:"forme_juridique",out:"categorie_juridique"},{in:"forme_juridique_code",out:"categorie_juridique_code"},{in:"naf_entreprise",out:"naf"},{in:"libelle_naf_entreprise",out:"libelle_naf"},{in:"tranche_effectif_salarie_entreprise.date_reference",out:"annee_tranche_effectif"},{in:"tranche_effectif_salarie_entreprise.intitule",out:"tranche_effectif"},{in:"tranche_effectif_salarie_entreprise",out:"entreprise_employeur",callback:function(e){return e&&+e.a>0}},{in:"mandataires_sociaux",out:"mandataires_sociaux",callback:function(e){return Array.isArray(e)?e.map(function(e){return{nom:e.nom,prenom:e.prenom,fonction:e.fonction,raison_sociale:e.raison_sociale}}):null}},{in:"date_creation",out:"date_de_creation",callback:function(e){return r.default.convertDate(e)}},{in:"date_radiation",out:"date_de_radiation",callback:function(e){return r.default.convertDate(e)}}];return e&&e.entreprise?(0,o.default)(e.entreprise,t):{}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`attestations_fiscales_dgfip/${e}`,n).then(function(e){return e&&e.url&&"string"==typeof e.url&&e.url.length?{attestation_dgfip:e.url}:{}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`attestations_sociales_acoss/${e}`,n).then(function(e){return e&&e.url&&"string"==typeof e.url&&e.url.length?{attestation_acoss:e.url}:{}})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),i=(r=o)&&r.__esModule?r:{default:r};const a=(s=function*(e,t,n){return yield i.default.requestAPI(t,`extraits_rcs_infogreffe/${e}`,n).then(function(e){if("object"!=typeof e||!e.siren)return{};const t={rcs_date_immatriculation:e.date_immatriculation};if(Array.isArray(e.observations)&&e.observations.length){const{date:n,libelle:r}=e.observations[0];t.rcs_information_libelle=r.trim(),t.rcs_information_date=n}return t})},u=function(){var e=s.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return u.apply(this,arguments)});var s,u;t.default=a},function(e,t,n){"use strict";var r=n(1),o=n(10),i=n(44),a=n(17);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var u=s(n(12));u.Axios=i,u.create=function(e){return s(a(u.defaults,e))},u.Cancel=n(18),u.CancelToken=n(62),u.isCancel=n(11),u.all=function(e){return Promise.all(e)},u.spread=n(63),e.exports=u,e.exports.default=u},function(e,t){e.exports=require("is-buffer")},function(e,t,n){"use strict";var r=n(1),o=n(45),i=n(46),a=n(17);function s(e){this.defaults=e,this.interceptors={request:new o,response:new o}}s.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head","options"],function(e){s.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){s.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}}),e.exports=s},function(e,t,n){"use strict";var r=n(1);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,n){"use strict";var r=n(1),o=n(47),i=n(11),a=n(12),s=n(60),u=n(61);function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!s(e.url)&&(e.url=u(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return c(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(1),o=n(13),i=n(15),a=n(50),s=n(51),u=n(16).http,c=n(16).https,f=n(52),l=n(53),d=n(54),p=n(7),h=n(14);e.exports=function(e){return new Promise(function(t,n){var m,v=function(e){clearTimeout(m),t(e)},y=function(e){clearTimeout(m),n(e)},_=e.data,g=e.headers;if(g["User-Agent"]||g["user-agent"]||(g["User-Agent"]="axios/"+d.version),_&&!r.isStream(_)){if(Buffer.isBuffer(_));else if(r.isArrayBuffer(_))_=new Buffer(new Uint8Array(_));else{if(!r.isString(_))return y(p("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));_=new Buffer(_,"utf-8")}g["Content-Length"]=_.length}var b=void 0;e.auth&&(b=(e.auth.username||"")+":"+(e.auth.password||""));var x=f.parse(e.url),w=x.protocol||"http:";if(!b&&x.auth){var j=x.auth.split(":");b=(j[0]||"")+":"+(j[1]||"")}b&&delete g.Authorization;var P="https:"===w,E=P?e.httpsAgent:e.httpAgent,S={path:i(x.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method,headers:g,agent:E,auth:b};e.socketPath?S.socketPath=e.socketPath:(S.hostname=x.hostname,S.port=x.port);var O,A=e.proxy;if(!A&&!1!==A){var k=w.slice(0,-1)+"_proxy",M=process.env[k]||process.env[k.toUpperCase()];if(M){var L=f.parse(M);if(A={host:L.hostname,port:L.port},L.auth){var q=L.auth.split(":");A.auth={username:q[0],password:q[1]}}}}if(A&&(S.hostname=A.host,S.host=A.host,S.headers.host=x.hostname+(x.port?":"+x.port:""),S.port=A.port,S.path=w+"//"+x.hostname+(x.port?":"+x.port:"")+S.path,A.auth)){var D=new Buffer(A.auth.username+":"+A.auth.password,"utf8").toString("base64");S.headers["Proxy-Authorization"]="Basic "+D}e.transport?O=e.transport:0===e.maxRedirects?O=P?s:a:(e.maxRedirects&&(S.maxRedirects=e.maxRedirects),O=P?c:u),e.maxContentLength&&e.maxContentLength>-1&&(S.maxBodyLength=e.maxContentLength);var U=O.request(S,function(t){if(!U.aborted){var n=t;switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":n=n.pipe(l.createUnzip()),delete t.headers["content-encoding"]}var r=t.req||U,i={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:r};if("stream"===e.responseType)i.data=n,o(v,y,i);else{var a=[];n.on("data",function(t){a.push(t),e.maxContentLength>-1&&Buffer.concat(a).length>e.maxContentLength&&y(p("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,r))}),n.on("error",function(t){U.aborted||y(h(t,e,null,r))}),n.on("end",function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding)),i.data=t,o(v,y,i)})}}});U.on("error",function(t){U.aborted||y(h(t,e,null,U))}),e.timeout&&(m=setTimeout(function(){U.abort(),y(p("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",U))},e.timeout)),e.cancelToken&&e.cancelToken.promise.then(function(e){U.aborted||(U.abort(),y(e))}),r.isStream(_)?_.on("error",function(t){y(h(t,e,null,U))}).pipe(U):U.end(_)})}},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("zlib")},function(e){e.exports={name:"axios",version:"0.18.0",description:"Promise based HTTP client for the browser and node.js",main:"index.js",scripts:{test:"grunt test && bundlesize",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},repository:{type:"git",url:"https://github.com/axios/axios.git"},keywords:["xhr","http","ajax","promise","node"],author:"Matt Zabriskie",license:"MIT",bugs:{url:"https://github.com/axios/axios/issues"},homepage:"https://github.com/axios/axios",devDependencies:{bundlesize:"^0.17.0",coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.0.2","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-nodeunit":"^1.0.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^20.1.0","grunt-karma":"^2.0.0","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^1.3.0","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.2.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",sinon:"^4.5.0",webpack:"^1.13.1","webpack-dev-server":"^1.14.1","url-search-params":"^0.10.0",typescript:"^2.8.1"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},typings:"./index.d.ts",dependencies:{"follow-redirects":"^1.4.1","is-buffer":"^2.0.2"},bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}]}},function(e,t,n){"use strict";var r=n(1),o=n(13),i=n(15),a=n(56),s=n(57),u=n(7),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(58);e.exports=function(e){return new Promise(function(t,f){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest,h="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||s(e.url)||(p=new window.XDomainRequest,h="onload",m=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var v=e.auth.username||"",y=e.auth.password||"";d.Authorization="Basic "+c(v+":"+y)}if(p.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[h]=function(){if(p&&(4===p.readyState||m)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};o(t,f,r),p=null}},p.onabort=function(){p&&(f(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){f(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){f(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var _=n(59),g=(e.withCredentials||s(e.url))&&e.xsrfCookieName?_.read(e.xsrfCookieName):void 0;g&&(d[e.xsrfHeaderName]=g)}if("setRequestHeader"in p&&r.forEach(d,function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),f(e),p=null)}),void 0===l&&(l=null),p.send(l)})}},function(e,t,n){"use strict";var r=n(1),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}}),a):a}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(){this.message="String contains an invalid character"}o.prototype=new Error,o.prototype.code=5,o.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,i=String(e),a="",s=0,u=r;i.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&t>>8-s%1*8)){if((n=i.charCodeAt(s+=.75))>255)throw new o;t=t<<8|n}return a}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(18);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(65),i=(r=o)&&r.__esModule?r:{default:r};t.default=i.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=f(n(9)),i=f(n(4)),a=f(n(66)),s=f(n(68)),u=f(n(70)),c=f(n(6));function f(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const d=t._={axios:Symbol("_axios"),requestAPIs:Symbol("_requestAPIs")};t.default=class extends i.default{constructor(e,t={}){super(),this.token=null,this[d.axios]=c.default.create({baseURL:e,timeout:3e4}),this.axiosConfig=t}getSIRET(e){var t=this;return l(function*(){return yield t[d.requestAPIs](e,s.default.getSettlement)})()}getSIREN(e){var t=this;return l(function*(){return yield t[d.requestAPIs](e,a.default.getEntreprise,s.default.getSettlements)})()}search(e){var t=this;return l(function*(){return yield u.default.getCompanyByName(e,t[d.axios],t.getAxiosConfig())})()}[d.requestAPIs](e,...t){var n=this;return l(function*(){let r={};const o=t.filter(function(e){return"function"==typeof e}).map(function(t){return t(e,n[d.axios],n.getAxiosConfig())});return yield Promise.all(o).then(function(e){Object.assign(r,...e)}),r})()}getAxiosConfig(){const e=r({},this.axiosConfig,{headers:{Authorization:`Bearer ${this.token}`}});if(e.proxy&&!0===e.proxy.tunnel){const t={proxy:{}};e.proxy.host&&(t.proxy.host=e.proxy.host),e.proxy.port&&(t.proxy.port=e.proxy.port),e.proxy.auth&&(t.proxy.proxyAuth=`${e.proxy.auth.username||""}:${e.proxy.auth.password||""}`),e.proxy=!1,e.httpsAgent=o.default.httpsOverHttp(t)}return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(67),i=(r=o)&&r.__esModule?r:{default:r};t.default={getEntreprise:i.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),o=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const s=(u=a(function*(e,t,n){return yield r.default.requestAPI(t,`siren/${e}`,n).then((i=a(function*(e){return e.uniteLegale?yield o.default.formatEnt(e.uniteLegale,n):{}}),function(e){return i.apply(this,arguments)}));var i}),function(e,t,n){return u.apply(this,arguments)});var u;t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(69)),o=i(n(19));function i(e){return e&&e.__esModule?e:{default:e}}t.default={getSettlement:r.default,getSettlements:o.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),o=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function r(o,i){try{var a=t[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});e(s)}("next")})}}const s=(u=a(function*(e,t,n){return yield r.default.requestAPI(t,`siret/${e}`,n).then((i=a(function*(e){return e.etablissement?yield o.default.formatEtab(e.etablissement,n):{}}),function(e){return i.apply(this,arguments)}));var i}),function(e,t,n){return u.apply(this,arguments)});var u;t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(71),i=(r=o)&&r.__esModule?r:{default:r};t.default={getCompanyByName:i.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=s(n(0)),i=s(n(2)),a=s(n(19));function s(e){return e&&e.__esModule?e:{default:e}}const u=(c=function*(e,t,n){const s=yield o.default.requestAPI(t,`siren/?q=periode(denominationUniteLegale:"${e}")&nombre=10000`,n);if(!s.unitesLegales)return[];const u=[];for(let e=0;e<s.unitesLegales.length;e++){const o=yield i.default.formatEnt(s.unitesLegales[e]),c=yield(0,a.default)(o.siren,t,n,!0);u.push(r({},o,c))}return u},f=function(){var e=c.apply(this,arguments);return new Promise(function(t,n){return function r(o,i){try{var a=e[o](i),s=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(s).then(function(e){r("next",e)},function(e){r("throw",e)});t(s)}("next")})},function(e,t,n){return f.apply(this,arguments)});var c,f;t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(21),i=c(o),a=c(n(20)),s=n(3),u=n(8);function c(e){return e&&e.__esModule?e:{default:e}}const f=Symbol("_ets"),l=Symbol("_etsModel");t.default=class extends i.default{constructor(e,t=a.default){super(),this[f]=[],this[l]=t,this.replaceData(e)}[o._protected._importData](e,t){const n=r({},e),i=n._ets;i&&(Array.isArray(i)||(i=[i]),i.forEach(e=>{e&&"object"==typeof e&&(0,s.validateSIRET)(e.siret)&&this.getEtablissement(e.siret).updateData((0,u.cleanObject)(e))}),delete n._ets),super[o._protected._importData](n,t)}get etablissements(){return this[f]}hasEtablissement(e){return!!this.getEtablissement(e,!1)}getEtablissement(e,t=!0){return this[f].find(t=>t.siret===e)||t&&this[f].push(new this[l]({siret:e},this))&&this.getEtablissement(e)||null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(21),a=(r=i)&&r.__esModule?r:{default:r},s=n(8);const u=Symbol("_entreprise");t.default=class extends a.default{constructor(e,t){super(),this[u]=t,this.replaceData(e)}[i._protected._importData](e){if(this[u]){const t=e&&e._etData;t&&"object"==typeof t&&(this[u].updateData((0,s.cleanObject)(t)),this[u].updateData({_dataSources:o({},this[u]._dataSources,e._dataSources)}),delete e._etData)}super[i._protected._importData](e)}}}])});